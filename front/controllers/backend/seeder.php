<?php/** * Created by PhpStorm. * User: Pramod Kadam * Date: 03-02-2016 * Time: 00:21 */class seeder extends CI_Controller{    function __construct()    {        parent::__construct();       $this->load->model('backend/seeder_model');    }    public function getFields()    {       $select = func_get_args();       $where = $this->input->post();        $this->db->start_cache();        $this->db->distinct();        $this->db->select($select);        $this->db->stop_cache();        $arr = ($where)?$this->seeder_model->get_by($where):$this->seeder_model->get($where);        return $this->output            ->set_content_type('application/json')            ->set_status_header(200)            ->set_output(json_encode($arr));    }    public function seedes(){        // this controller can only be called from the command line//        if (!$this->input->is_cli_request()) show_error('Direct access is not allowed');        $this->load->library('xml_array');        if ($file= file_get_contents("https://data.gov.in/sites/default/files/Date-Wise-Prices-all-Commodity.xml")) { // Relative to APPPATH, ".xml" appended            $arrayFormatted = $this->xml_array->createArray($file);            $xmlArray = $arrayFormatted['soap:Envelope']['soap:Body']['showResponse']['showResult'] ["diffgr:diffgram"] ["NewDataSet"]["Table"];            foreach($xmlArray as $xmlData){                unset($xmlData["@attributes"]);                $xmlData['Arrival_Date']= date('Y-m-d',strtotime(str_replace("/","-",$xmlData['Arrival_Date'])));//               print_r($xmlData);               $old_data= $this->seeder_model->get_by($xmlData);                if(!$old_data)                 $this->seeder_model->save($xmlData);            }            echo 'Done! uploaded records' . count($xmlArray);        }    }}